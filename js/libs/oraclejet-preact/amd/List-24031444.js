define(["exports","preact/jsx-runtime","preact/hooks",'module',"./utils/UNSAFE_classNames","./utils/UNSAFE_mergeProps","./utils/UNSAFE_keys","./LoadMoreCollection-d53c66bf","./PRIVATE_VirtualizedCollection","./hooks/UNSAFE_useTabbableMode","./UNSAFE_FocusTrap","./hooks/UNSAFE_useId","./classNames-f11010a7","./FocusTrap-5a3a8c7d","./hooks/PRIVATE_useSelection","./hooks/PRIVATE_useCurrentKey","./hooks/PRIVATE_useCollectionFocusRing","./hooks/PRIVATE_useTabbableModeSet","./hooks/PRIVATE_useItemAction","./UNSAFE_Skeleton","./UNSAFE_Flex","./utils/PRIVATE_collectionUtils","./UNSAFE_Selector","./VirtualizedCollection-8523118a","./Flex-e3a46a36","./Skeleton-65cc3876"],function(e,t,n,i,s,l,o,r,a,c,u,d,g,m,b,f,v,y,x,h,k,p,j,S,A,C){"use strict";const E=e=>{switch(e){case"listbox":return{list:"listbox",item:"presentation",cell:"option"};case"treegrid":return{list:"treegrid",item:"row",cell:"gridcell"};default:return{list:"grid",item:"row",cell:"gridcell"}}},T="oj-listview-item",_=".oj-listview-item",w="_13lzws0",F="dwt0ny",R="_1ynass",I="_4bu39k",K="q2ijk8",P="_9jqud3",V="_1r34vu1",N="_190w4ld",M="_1eyhads",z="_7rt13l",O="_1iub12f";function U({children:e,itemKey:i,itemIndex:s,isFocused:l,isFocusRingVisible:o,isGridlineVisible:r,isSelected:a,isTopGridlineVisible:u=!1,isTabbable:b=!1,role:f,selectionMode:v,suggestion:y,currentItemVariant:x}){const h=n.useRef(null),k=n.useMemo(()=>E(f),[f]),p="option"===k.cell?{role:k.cell,"aria-posinset":s+1,"aria-setsize":-1}:{role:k.cell},j=g.classNames([w,T,l&&o&&M,r&&F,u&&R,L(v,a)&&!a&&I,a&&K,a&&"single"===v&&P,"end"===y&&!r&&!(a&&"single"===v)&&V,"highlight"===x&&l&&!a&&N]),S=g.classNames([z,"multiple"===v&&O]);return t.jsx("div",Object.assign({"aria-rowindex":s+1,"data-oj-key":i,class:j,ref:h,role:k.item},y&&{"data-oj-suggestion":!0},"number"==typeof i&&{"data-oj-key-type":"number"},{children:t.jsx("div",Object.assign({id:d.useId(),class:S,"aria-posinset":s+1,"aria-setsize":-1,onKeyDown:e=>{!b||"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation()},"aria-colindex":1,"aria-selected":"none"!==v?a:void 0},p,{children:t.jsx(c.TabbableModeContext.Provider,Object.assign({value:{isTabbable:b}},{children:t.jsx(m.FocusTrap,Object.assign({isDisabled:!b,restoreFocusRef:!1},{children:e}))}))}))}))}const L=(e,t)=>"none"!==e&&("multiple"===e||!t),D="tll2q0";function q({children:e,minimumCount:i=1}){const[s,l]=n.useState(!1);n.useEffect(()=>{setTimeout(()=>{l(!0)},50)},[]);const o=g.classNames([D]);return s&&e?t.jsx("div",Object.assign({class:o,role:"presentation"},{children:[...Array(i)].map((t,n)=>e(n))})):null}const H="_1030ilv",B="e14jx2",G="bkvk9l";const Y=e=>{const t=null==e?void 0:e.data,n=$(t);if(0===n)return null;return t.slice(0,n).reduce((e,t,i)=>{const s=t.metadata.key;return i===n-1?e.set(s,"end"):e.set(s,!0),e},new Map)},$=e=>{if(!e)return 0;const t=e.findIndex(e=>!e.metadata.suggestion);return-1===t?0:t},J=(e,t)=>{if(e&&t){const n=t.getBoundingClientRect(),i=e.getBoundingClientRect();i.bottom>n.bottom?t.scrollTop=t.scrollTop+(i.bottom-n.bottom):i.top<n.top&&(t.scrollTop=t.scrollTop-(n.top-i.top))}},Q=(e,t)=>null!=t?t:{scroller:()=>e.current},W={all:!1,keys:new Set},X=(e,t)=>{const n=t.data.map(e=>e.metadata.key),i=n.indexOf(e.value.start),s=n.indexOf(e.value.end),l=Math.min(i,s),o=Math.max(i,s);return-1===l?{offset:0,count:t.totalSize}:n.slice(l,o+1)};function Z({sparkleHeight:e}){if(e<=0)return null;const n=e+"px",i=g.classNames([B]),s=g.classNames([G]);return t.jsx("div",Object.assign({class:s},{children:t.jsx("div",{class:i,style:{height:n}})}),"sparkle")}const ee=t.jsx(q,Object.assign({minimumCount:25},{children:()=>t.jsx(A.Flex,Object.assign({height:"12x",align:"center"},{children:t.jsx(C.Skeleton,{height:"4x"})}))})),te=t.jsx(q,Object.assign({minimumCount:3},{children:()=>t.jsx(A.Flex,Object.assign({height:"12x",align:"center"},{children:t.jsx(C.Skeleton,{height:"4x"})}))})),ne=(e,t)=>{if(t){const n=Math.min(t.offset,e.offset+e.totalSize),i=n-e.offset;i>0&&(e={offset:n,data:e.data.slice(i,i+t.count),totalSize:e.totalSize,sizePrecision:e.sizePrecision})}return e};e.List=function({accessibleSummary:e,allowTabbableMode:i=!0,children:s,currentKey:a,data:c,gridlines:u,loadingIndicator:d=ee,onCurrentKeyChange:m,onLoadRange:h,onSelectionChange:k,onItemAction:A,rangeExtractor:C,role:T="grid",selectedKeys:w=W,selectionMode:F="none",viewportConfig:R,currentItemVariant:I="none",isVirtualized:K=!0}){const P=n.useRef(null),V=n.useMemo(()=>E(T),[T]),N=n.useRef(),M=n.useRef(),z=n.useRef(),[O,L]=n.useState(0),D="none"===F?void 0:"multiple"===F,q=null===c?void 0:"exact"===c.sizePrecision?c.totalSize:-1,B=g.classNames([H]),{currentKeyProps:G}=f.useCurrentKey(e=>p.keyExtractor(e,_),p.getPrevNextKey(P.current,a,!0,_),p.getPrevNextKey(P.current,a,!1,_),a,m),$=e=>{var t;return!!(null===(t=P.current)||void 0===t?void 0:t.contains(e))},[ie,se]=v.useCollectionFocusRing($,["ArrowUp","ArrowDown"]);let le=!1;const[oe,re]=y.useTabbableModeSet($,e=>p.keyExtractor(e,_),a,(e,t)=>{var n;(null===e||$(e))&&(t?(le=!0,setTimeout(()=>{var e;null===(e=P.current)||void 0===e||e.focus()},0)):null===(n=P.current)||void 0===n||n.focus())},e=>{m&&m({value:e})});n.useEffect(()=>{if(null!=a&&P.current){const e=p.findElementByKey(P.current,a,_);if(e){const t=null==R?void 0:R.scroller();J(e,null!=t?t:P.current);const n=e.querySelector(`[role=${V.cell}]`);n&&P.current.setAttribute("aria-activedescendant",n.id)}}},[a,c,V.cell,R]);const ae=n.useCallback(e=>{k&&(!1===e.value.all&&e.value.keys.size>0&&(N.current=Array.from(e.value.keys.values()).pop()),k(e))},[N,k]),ce=n.useCallback(e=>{if(c&&k){const t=X(e,c);Array.isArray(t)?k({value:{all:!1,keys:new Set(t)},target:null}):(M.current={detail:e,range:{offset:c.offset,count:c.data.length}},h(t))}},[c,k,h]),ue=n.useCallback(()=>{if(P.current&&m&&(!i||oe(void 0))){const e=z.current||p.getFirstVisibleKey(P.current,_);o.isKeyDefined(e)&&m({value:e})}},[i,m,oe]),de=n.useCallback(e=>{var t,n;const i=p.keyExtractor(e.target,_);i&&"checkbox"===(null===(t=e.relatedTarget)||void 0===t?void 0:t.getAttribute("type"))&&(null===(n=P.current)||void 0===n||n.focus(),m&&i&&m({value:i}))},[m]),ge=n.useCallback(e=>{!o.isKeyDefined(a)&&m&&ue(),!i&&de(e)},[i,a,ue,de,m]),{selectionProps:me}=b.useSelection(e=>e===P.current?void 0===a?null:a:p.keyExtractor(e,_),w,F,!1,"replace",ae,N.current,a,(e,t)=>p.getPrevNextKey(P.current,e,t,_),e=>{if(P.current){const t=p.findElementByKey(P.current,e,_);if(t){const e=null==R?void 0:R.scroller();J(t,null!=e?e:P.current)}}},ce);if(c&&void 0!==M.current&&k){const e=X(M.current.detail,c);Array.isArray(e)&&k({value:{all:!1,keys:new Set(e)},target:null});const t=M.current?M.current.range:{offset:c.offset,count:c.data.length};c=ne(c,t),M.current=void 0,h(t)}const be=n.useMemo(()=>Y(c),[c]),fe=t.jsx(Z,{sparkleHeight:O}),ve=x.useItemAction(a,c,A,_);n.useEffect(()=>{var e,t;if(be){const n=null===(e=P.current)||void 0===e?void 0:e.querySelector("."+S.PLACEHOLDER_STYLE_CLASS);let i=(null==n?void 0:n.offsetHeight)||0;const s=null===(t=P.current)||void 0===t?void 0:t.querySelectorAll("[data-oj-suggestion]");null==s||s.forEach(e=>i+=e.offsetHeight),L(i)}},[be]);const ye=n.useCallback(e=>{const n="multiple"===F?()=>t.jsx(j.Selector,{onChange:ae,rowKey:e.data.metadata.key,selectedKeys:w}):void 0;return{index:e.index,data:e.data.data,metadata:e.data.metadata,selector:n}},[F,w,ae]),xe=e=>{const n=ye(e),l=null==be?void 0:be.get(n.metadata.key),r=i&&oe(n.metadata.key),d=a===n.metadata.key&&!r,g=o.containsKey(w,n.metadata.key);return t.jsx(U,Object.assign({isFocused:d,isFocusRingVisible:ie&&!le,isGridlineVisible:(m=n.index,"visible"===(null==u?void 0:u.item)&&(m+1!==(null==c?void 0:c.totalSize)||"visible"===(null==u?void 0:u.bottom))),isSelected:g,isTabbable:i&&oe(n.metadata.key),itemIndex:n.index,itemKey:n.metadata.key,role:T,selectionMode:F,currentItemVariant:I},l&&{suggestion:l},0===n.index&&{isTopGridlineVisible:"visible"===(null==u?void 0:u.item)&&"visible"===(null==u?void 0:u.top)},{children:s(n)}),n.metadata.key);var m};R=Q(P,R);const he=K?t.jsx(S.VirtualizedCollection,Object.assign({data:c,itemSelector:_,loadMoreIndicator:te,onLoadRange:h,rangeExtractor:C,suggestions:fe,viewportConfig:R},{children:xe})):t.jsx(r.LoadMoreCollection,Object.assign({data:c,loadMoreIndicator:te,onLoadRange:h,suggestions:fe,viewportConfig:R},{children:xe})),ke=n.useCallback(e=>{const t=p.keyExtractor(e.target,_);o.isKeyDefined(t)&&(z.current=t)},[]);return t.jsx("div",Object.assign({},l.mergeProps(i?re:{},G,se,me,ve,{onFocus:ge,onPointerDown:ke}),{role:T,"aria-rowcount":q,"aria-colcount":1,ref:P,class:B,tabIndex:0,"aria-label":e,"aria-multiselectable":D},{children:null==c?d:he}))},e.SkeletonContainer=q});
//# sourceMappingURL=List-24031444.js.map
